<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>调试buildings.js</title>
</head>
<body>
    <h1>buildings.js调试</h1>
    <button onclick="testLoadBuildings()">测试加载建筑数据</button>
    <div id="result"></div>
    
    <script>
        // 复制buildings.js中的关键代码
        let buildingsPageData = [];
        let buildingsCurrentFilter = 'all';
        let tagsData = [];
        
        async function testLoadBuildings() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>正在测试...</p>';
            
            try {
                const githubUrl = 'https://cdn.jsdelivr.net/gh/CNHongQian/ChuangYiFangKuai@main/data/content_data.json?t=' + Date.now();
                console.log('请求URL:', githubUrl);
                
                const response = await fetch(githubUrl, {
                    signal: new AbortController().signal,
                    timeout: 10000
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP错误: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('获取到的数据:', data);
                console.log('数据总数:', data.length);
                
                // 统计各类别数量
                const categoryStats = {};
                data.forEach(item => {
                    const cat = item.category || 'unknown';
                    categoryStats[cat] = (categoryStats[cat] || 0) + 1;
                });
                console.log('分类统计:', categoryStats);
                
                // 过滤建筑类型的数据
                buildingsPageData = data
                    .filter(item => {
                    console.log('过滤项目:', item, 'category:', item.category, 'type:', item.type);
                    return item.category === 'building' || item.type === 'building';
                })
                    .map(item => ({
                        ...item,
                        type: item.type || item.category || 'building',
                        downloads: item.downloads || 0,
                        likes: item.likes || 0,
                        views: item.views || 0
                    }));
                
                console.log('过滤后的建筑数据:', buildingsPageData);
                console.log('建筑数据长度:', buildingsPageData.length);
                
                resultDiv.innerHTML = `
                    <h2>测试结果</h2>
                    <p><strong>总数据数:</strong> ${data.length}</p>
                    <p><strong>建筑数据数:</strong> ${buildingsPageData.length}</p>
                    <h3>分类统计:</h3>
                    <pre>${JSON.stringify(categoryStats, null, 2)}</pre>
                    <h3>前10个建筑:</h3>
                    <pre>${JSON.stringify(buildingsPageData.slice(0, 10), null, 2)}</pre>
                `;
                
            } catch (error) {
                console.error('错误:', error);
                resultDiv.innerHTML = `<p style="color: red;">错误: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>